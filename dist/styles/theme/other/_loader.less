//////////////////////
// loader
//////////////////////

// spinner

.spinner {
  width: 25px;
  height: 25px;
  .btn & {
    width: 1em;
    height: 1em;
  }
  line-height: 0;
  svg {
    filter: drop-shadow(0 .1rem .2rem fade(@black, @perc--sm)) drop-shadow(0 .2rem .4rem fade(@black, @perc--md));
    circle {
      fill: none;
      stroke-width: 30;
      transform: rotateY(0deg) rotateZ(-90deg);
      transform-origin: center center;
      .btn & {
        stroke-width: 40;
      }
    }
    &:nth-child(1) {
      position: absolute;
      circle {
        position: absolute;
        top: 0;
        left: 0;
        stroke: fade(@white, 50%);
        stroke-dashoffset: 0;
      }
    }
    &:nth-child(2) {
      circle {
        stroke: fade(@primary, @perc--xl);
        stroke-dashoffset: 1;
        animation: anim-spinner @time--giant infinite @bez--in;
      }
    }
  }
}

@keyframes anim-spinner {
  0% {
    stroke-dashoffset: 1;
    transform: rotateY(0deg) rotateZ(-90deg);
  }
  50% {
    stroke-dashoffset: 0;
    transform: rotateY(0deg) rotateZ(90deg);
    animation-timing-function: @bez--out;
  }
  51% {
    stroke-dashoffset: 0;
    transform: rotateY(180deg) rotateZ(90deg);
  }
  100% {
    stroke-dashoffset: 1;
    transform: rotateY(180deg) rotateZ(-90deg);
  }
}

// direction

.loader--x {
  .progress {
    span:nth-child(1) {
      background: @gray--250;
    }
    span:nth-child(2) {
      background: linear-gradient(90deg, @grad--primary);
      box-shadow: 0 .1rem 1rem fade(@primary, @perc--md), 0 .2rem 2rem fade(@primary, @perc--lg);
      animation: anim-loader--x @time--giant infinite @bez--in;
    }
  }
}

.loader--y {
  .progress {
    span:nth-child(1) {
      background: @gray--250;
    }
    span:nth-child(2) {
      background: linear-gradient(0deg, @grad--primary);
      box-shadow: 0 .1rem 1rem fade(@primary, @perc--md), 0 .2rem 2rem fade(@primary, @perc--lg);
      animation: anim-loader--y @time--giant infinite @bez--in;
    }
  }
}

@keyframes anim-loader--x {
  0% {
    left: 0;
    width: 0;
  }
  50% {
    left: 0;
    width: 100%;
    animation-timing-function: @bez--out;
  }
  100% {
    left: 100%;
    width: 0;
  }
}

@keyframes anim-loader--y {
  0% {
    top: 100%;
    height: 0;
  }
  50% {
    top: 0;
    height: 100%;
    animation-timing-function: @bez--out;
  }
  100% {
    top: 0;
    height: 0;
  }
}

// size

.loader--size-x,
.loader--size-top,
.loader--size-bottom {
  .progress {
    height: 3px;
  }
}

.loader--size-y,
.loader--size-left,
.loader--size-right {
  .progress {
    width: 3px;
  }
}

.loader--size-x {
  .progress {
    left: 25%;
    right: 25%;
  }
}

.loader--size-y {
  .progress {
    top: 25%;
    bottom: 25%;
  }
}

// background

.loader--background {
  background: fade(@white, @perc--xl);
}

// animations

.loader {
  &.active {
    .anim-opacity.active();
    .spinner, .progress {
      .anim-x.active();
      animation-delay: @time--medium;
    }
  }
  &.out {
    .anim-opacity.out();
    animation-delay: @time--medium;
    .spinner, .progress {
      .anim-x.out();
    }
  }
}

.loader--js {
  // disable animations
  .spinner {
    circle {
      .trans-anim-none() !important;
    }
  }
  .progress {
    span {
      .trans-anim-none() !important;
    }
  }
}
